---
template: "templates/OpsWorks-stack.cfn.yml"

cloudformation_stacks:
  - name: "CKAN-PROD-OpsWorks-stack"
    state: "{{ state | default('present')}}"
    region: "{{ region }}"
    disable_rollback: true
    template: "{{ template }}"
    template_parameters:
      Environment: PROD
      ApplicationName: "CKAN"
      ApplicationId: "ckan"
      StackTLD: ckan-internal.services.qld.gov.au
      StackVPC: "CKANVpc-{{ Environment }}"
      DefaultEC2Key: osssio-global-ckan
      AppSubnets: "{{ Environment }}CKANAppSubnet"
      AdminSG: "{{ Environment }}CKANManagementSG"
      DatabaseSG: "{{ Environment }}CKANDatabaseSG"
      CKANSource: https://github.com/ckan/ckan/archive/ckan-2.7.3.zip
      CreateServiceRole: "yes"
    tags:
      Environment: "{{ Environment }}"
      Service: "CKAN"
      Division: "{{ Division }}"
      Owner: "{{ Owner }}"
      Version: "1.0"
      PowerManaged: "No"

  - name: "CKAN-STAGING-OpsWorks-stack"
    state: "{{ state | default('present')}}"
    region: "{{ region }}"
    disable_rollback: true
    template: "{{ template }}"
    template_parameters:
      Environment: STAGING
      ApplicationName: "CKAN"
      ApplicationId: "ckan"
      StackTLD: ckan-internal.staging-services.qld.gov.au
      StackVPC: "CKANVpc-{{ Environment }}"
      DefaultEC2Key: osssio-global-ckan
      AppSubnets: "{{ Environment }}CKANAppSubnet"
      AdminSG: "{{ Environment }}CKANManagementSG"
      DatabaseSG: "{{ Environment }}CKANDatabaseSG"
      CKANSource: https://github.com/ckan/ckan/archive/ckan-2.7.3.zip
      CreateServiceRole: "yes"
    tags:
      Environment: "{{ Environment }}"
      Service: "CKAN"
      Division: "{{ Division }}"
      Owner: "{{ Owner }}"
      Version: "1.0"
      PowerManaged: "No"

  - name: "CKAN-TRAINING-OpsWorks-stack"
    state: "{{ state | default('present')}}"
    region: "{{ region }}"
    disable_rollback: true
    template: "{{ template }}"
    template_parameters:
      Environment: TRAINING
      ApplicationName: "CKAN"
      ApplicationId: "ckan"
      StackTLD: ckan-internal.training-services.qld.gov.au
      StackVPC: "CKANVpc-{{ Environment }}"
      DefaultEC2Key: osssio-global-ckan
      AppSubnets: "{{ Environment }}CKANAppSubnet"
      AdminSG: "{{ Environment }}CKANManagementSG"
      DatabaseSG: "{{ Environment }}CKANDatabaseSG"
      CKANSource: https://github.com/ckan/ckan/archive/ckan-2.7.3.zip
      CreateServiceRole: "yes"
    tags:
      Environment: "{{ Environment }}"
      Service: "CKAN"
      Division: "{{ Division }}"
      Owner: "{{ Owner }}"
      Version: "1.0"
      PowerManaged: "Yes"

  - name: "CKAN-DEV-OpsWorks-stack"
    state: "{{ state | default('present')}}"
    region: "{{ region }}"
    disable_rollback: true
    template: "{{ template }}"
    template_parameters:
      Environment: DEV
      ApplicationName: "CKAN"
      ApplicationId: "ckan"
      StackTLD: internal.ckan.devpit140cs.qgov.net.au
      StackVPC: "CKANVpc-{{ Environment }}"
      DefaultEC2Key: osssio-global-ckan
      AppSubnets: "{{ Environment }}CKANAppSubnet"
      AdminSG: "{{ Environment }}CKANManagementSG"
      DatabaseSG: "{{ Environment }}CKANDatabaseSG"
      CKANSource: https://github.com/ckan/ckan/archive/ckan-2.7.5.zip
      CreateServiceRole: "yes"
    tags:
      Environment: "{{ Environment }}"
      Service: "CKAN"
      Division: "{{ Division }}"
      Owner: "{{ Owner }}"
      Version: "1.0"
      PowerManaged: "Yes"
